{% extends 'base.html.twig' %}

{% block stylesheets %}
    {{ parent() }}
    <link href='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/main.min.css' rel='stylesheet' />
    <style>
        #calendar {
            height: 800px; /* Hauteur obligatoire */
            width: 100%;
            margin: 20px auto;
            font-family: Arial, sans-serif;
        }
        .fc-header-toolbar {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
        }
    </style>
{% endblock %}

{% block body %}
<div class="container-fluid">
    <div class="row">
        <!-- Calendrier -->
        <div class="col-md-9">
            <div id="calendar"></div>
        </div>
        
        <!-- Sidebar -->
        <div class="col-md-3 bg-light p-3">
            <h4>Créneaux disponibles</h4>
            <div id="timeslots-list">
                {% for event in events %}
                    <div class="mb-2 p-2 rounded" style="background-color: {{ event.color }}; color: white;">
                        <strong>{{ event.title }}</strong><br>
                        {{ event.start|date('d/m/Y H:i') }} - {{ event.end|date('H:i') }}<br>
                        {{ event.extendedProps.reserved ? 'Réservé' : 'Disponible' }}
                    </div>
                {% endfor %}
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script>
        // On passe les événements au JS via un data-attribute
        document.addEventListener('DOMContentLoaded', function() {
            const calendarDiv = document.getElementById('calendar');
            if (calendarDiv) {
                calendarDiv.setAttribute('data-events', JSON.stringify({{ events|json_encode|raw }}));
            }
        });
    </script>
{% endblock %}
